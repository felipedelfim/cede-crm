{% extends 'cashflow/base.html' %}

{% block content %}
<div class="row">
	<div class="col-lg-12">
		<h1 class="page-header">Transações</h1>
	</div>
	<!-- /.col-lg-12 -->
</div>
<!-- /.row -->


<div class="row">
	<div class="col-lg-12">
		<div class="panel panel-default">
			<div class="panel-heading">
				Adicionar / Editar
			</div>
			<!-- /.panel-heading -->
			<div class="panel-body">
				<form method="POST" class="post-form">{% csrf_token %}
					{% include "cashflow/form_snippet.html" %}
					<button type="submit" class="save btn btn-default">Salvar</button>
				</form>
			</div>
			<!-- /.panel-body -->
		</div>
		<!-- /.panel -->
	</div>
	<!-- /.col-lg-12 -->
</div>
<!-- /.row -->

{% endblock %}

{% block script %}
<script>

function update_item_value() {
	var id_item = $(this).val();
	var url = "{% url 'cashflow:item_get_value' pk=0 %}".replace("0", id_item);
	$.ajax({
		url: url,
		dataType: 'json',
		success: function (data) {
			if (data.value) {
				$("#id_item_value").val( data.value );
				update_total();
			}
		}
	});

}

function update_total() {
	$("#id_total").val( $("#id_item_value").val() * $("#id_amount").val() );
}

$("#id_amount").change(update_total);
$("#id_item_value").change(update_total);
$("#id_item").change(update_item_value);

$('.date').daterangepicker({
	singleDatePicker: true,
	//autoUpdateInput: false,
	locale:	{
		format: 'DD/MM/YYYY'
	}
});

</script>
{% endblock %}
