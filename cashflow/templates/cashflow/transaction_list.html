{% extends 'cashflow/base.html' %}

{% block header %}Transações{% endblock %}

{% block content %}

{% include "cashflow/form_filter_snippet.html" %}


<div class="col-md-12 col-sm-12 col-xs-12">
  <div class="x_panel">
	<div class="x_title">
	  <h2>Lista</h2>
	  <ul class="nav navbar-right panel_toolbox">
		<li><a class="collapse-link"><i class="fa fa-chevron-up"></i></a>
		</li>
	  </ul>
	  <div class="clearfix"></div>
	</div>
	<div class="x_content">
		{% if object_list %}
		<table width="100%" class="table table-striped table-hover">
			<thead>
				<tr>
					<th> Frequentador </th>
					<th> Grupo </th>
					<th> Item </th>
					<th> Qtd. </th>
					<th> Total </th>
					<th> Data </th>
					<th> Forma </th>
					<th> Status </th>
					<th> Ações </th>
				</tr>
			</thead>
			<tbody>
				{% for transaction in object_list %}
				<tr>
					<td> {{ transaction.person.name }} </td>
					<td> {{ transaction.person.group.name }} </td>
					<td> {{ transaction.item.name }} </td>
					<td class="text-right"> {{ transaction.amount }} </td>
					<td class="text-right"> {{ transaction.total }} </td>
					<td> {{ transaction.transacted_at|date:"d/m/y" }} </td>
					<td> {{ transaction.method.name }} </td>
					<td>
						{% if transaction.was_paid %}
						<span class="label label-success">Pago</span>
						{% else %}
						<span class="label label-warning">Não Pago</span>
						{% endif %}
					</td>
					<td class="text-center">
						<div class="btn-group">
							<a type="button" class="btn btn-outline btn-primary btn-xs" href="{% url 'cashflow:transaction_edit' pk=transaction.pk %}"><span class="glyphicon glyphicon-pencil" aria-hidden="true"></span></a>
							<a type="button" class="btn btn-outline btn-primary btn-xs dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
								<span class="caret"></span>
							</a>
							<ul class="dropdown-menu">
								<li><a href="{% url 'cashflow:transaction_edit' pk=transaction.pk %}">Editar</a></li>
								{% if transaction.was_paid == False %}
								<li><a href="{% url 'cashflow:transaction_pay' pk=transaction.pk %}">Marcar como Pago</a></li>
								{% endif %}
								<li role="separator" class="divider"></li>
								<li><a href="{% url 'cashflow:transaction_remove' pk=transaction.pk %}">Excluir</a></li>
							</ul>
						</div>
					</td>
				</tr>
				{% endfor %}
			</tbody>
		</table>
		{% include "cashflow/pagination_snippet.html" %}
		{% else %}
		<p>Não há transações disponíveis.</p>
		{% endif %}
	</div>
  </div>
</div>
{% endblock %}
